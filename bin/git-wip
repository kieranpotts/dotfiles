#!/bin/sh

# ==============================================================================
# Git alias for quickly saving work-in-progress.
#
# Usage:
#
# ```
# git wip ("[comment]")
# ```
#
# If an unset-or-empty commit message is provided, "WIP" becomes the commit
# message, else " - WIP" is appended to the custom message. For example,
# the command `git wip "My commit message"` produces a new commit with the
# log message "My commit message - WIP".
#
# WIP commits are intended for backup purposes and to be fixed-up manually
# later, or ultimately squashed into another branch. `git fixup` provides
# an alternative workflow.
# ==============================================================================

git add --all

# If there's an environment variable called `X_GIT_COMMIT_VERIFY` and its value
# is `0`, then we apply the `--no-verify` flag to the `git commit` operation.
VERIFY=${X_GIT_COMMIT_VERIFY:-1}

if [ "$VERIFY" -eq "0" ]; then
  git commit --quiet --no-verify --message "${1:-WIP}${1+ - WIP}"
else
  git commit --quiet --message "${1:-WIP}${1+ - WIP}"
fi
